<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="bingo.css">
    <title>Final</title>
    <script>
        const createBingo = (user) => {
            let num = Array.from(Array(75).keys(), x => x+1);
            for (let i = 0; i < 5; i++) {
                let table = document.getElementById(user);
                let row = document.createElement("tr");
                table.appendChild(row);
                for (let j = 0; j < 5; j++) {
                    let random = Math.floor(Math.random() * num.length);
                    let number = num[random];
                    num = num.filter(x => x != number);
                    let data = document.createElement("td");
                    row.appendChild(data);
                    if (i == 2 && j == 2) {
                        data.innerHTML = "free";
                        data.setAttribute("id", "hit");
                    } else {
                        data.innerHTML = number;
                        data.setAttribute("id", "normal");
                    }
                }
            }
        }
    </script>
</head>

<body>
    <h1 id="title">Bingo Game</h1>
    <div>
        <div id="number_brock">
            <p id="middle-title">次は</p>
            <p id="number"></p>
        </div>

        <div id="result_block">
            <p id="middle-title">出た数字</p>
            <div id="result_list">
                <p id="result"></p>
            </div>
        </div>

        <div id="button_block">
            <button id="start_stop">スタート</button>
        </div>
    </div>

    <div id="card">
        <p id="player">YOU</p>
        <table id="you" border="1">
            <script>
                createBingo("you");
                let card = [];
                let td = document.getElementsByTagName("td");
                for (let i=0; i<25; i++) {
                    for (let j=0; j<5; j++) {
                        
                        separate.push(td[i].innerHTML);
                    }
                }
                console.log(card);
            </script>
        </table>
    </div>

    <div id="card">
        <p id="player">COM1</p>
        <table id="com1" border="1">
            <script>
                createBingo("com1");
            </script>
        </table>
    </div>

    <div id="card">
        <p id="player">COM2</p>
        <table id="com2" border="1">
            <script>
                createBingo("com2");
            </script>
        </table>
    </div>


    <script>
        let last = Array.from(Array(75).keys(), x => x+1);
        let results = []
        let button = document.getElementById("start_stop");
        // 数字を引く
        const randnum = () => {
            let random = Math.floor(Math.random() * last.length);
            let number = document.getElementById("number");
            number.innerHTML = last[random];
        }

        // スタート・ストップ
        console.log(last.length);
        const start_stop = () => {
            let message = ["スタート", "ストップ"];
            if (button.innerHTML == message[0]) {
                button.innerHTML = message[1];
                shuffle = setInterval(randnum, 10);
            } else {
                button.innerHTML = message[0];
                clearInterval(shuffle);
                let rowNum = document.getElementById("number").innerHTML;
                num = ("00" + rowNum).slice(-2);
                let result = document.getElementById("result");
                let newResults = document.createElement("p");
                result.appendChild(newResults);
                newResults.innerHTML = num;
                last = last.filter(x => x != rowNum);
                results.push(num);
                let td = document.getElementsByTagName("td");
                // console.log(td);
                for (let i = 0; i < td.length; i++) {
                    if (td[i].innerHTML == rowNum) {
                        td[i].setAttribute("id", "hit");
                    }
                }
            }
        }

        button.addEventListener("click", start_stop, false);
    </script>

</body>

</html>
